"use client";
import Link from "next/link";
import React, { useId } from "react";

interface ButtonTourProps {
  name?: string;
  href?: string;
  className?: string; // có thể truyền w-[...] max-w-[...] v.v.
  type?: "button" | "submit" | "reset";
  disabled?: boolean;
  onClick?: () => void;
  fullWidth?: boolean; // true: chiếm full chiều ngang parent
  maxWidth?: string; // ví dụ: "max-w-[360px]" (mặc định 299px)
}

const cx = (...a: (string | false | undefined)[]) => a.filter(Boolean).join(" ");

const ButtonTour = ({
  name = "Book Tour",
  href,
  className,
  type = "button",
  disabled = false,
  onClick,
  fullWidth = false,
  maxWidth = "max-w-[299px]", // vẫn giới hạn mặc định như bản gốc
}: ButtonTourProps) => {
  const uniqueId = useId().replace(/:/g, "_"); // Tạo unique ID cho SVG elements
  const Inner = (
    <>
      {/* BG SVG fill container */}
      <div className="absolute inset-0  pointer-events-none">
        <svg
          viewBox="0 0 299 41"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          className="w-full h-full"
        >
          <g clipPath={`url(#clip0_${uniqueId})`}>
            <path
              d="M1.35739 2.375C1.35739 1.875 4.97711 0.916667 6.78697 0.5H291.84L297.269 1.75V3.625L286.41 4.875L297.269 5.5C298.174 9.04167 299.712 16 298.626 15.5C297.541 15 290.03 16.5417 286.41 17.375H297.269C296.817 22.1667 295.64 32.25 294.554 34.25C293.468 36.25 293.197 38 293.197 38.625L287.767 40.5H9.50175L5.42957 39.25C3.61971 35.0833 0 26.625 0 26.125C0 25.625 7.23943 24.6667 10.8591 24.25L1.35739 23.625L0 16.75H6.78697L1.35739 15.5V2.375Z"
              fill="#6C8A1F"
            />
            <mask
              id={`mask0_${uniqueId}`}
              style={{ maskType: "alpha" } as any}
              maskUnits="userSpaceOnUse"
              x="0"
              y="0"
              width="299"
              height="41"
            >
              <path
                d="M1.35739 2.375C1.35739 1.875 4.97711 0.916667 6.78697 0.5H291.84L297.269 1.75V3.625L286.41 4.875L297.269 5.5C298.174 9.04167 299.712 16 298.626 15.5C297.541 15 290.03 16.5417 286.41 17.375H297.269C296.817 22.1667 295.64 32.25 294.554 34.25C293.468 36.25 293.197 38 293.197 38.625L287.767 40.5H9.50175L5.42957 39.25C3.61971 35.0833 0 26.625 0 26.125C0 25.625 7.23943 24.6667 10.8591 24.25L1.35739 23.625L0 16.75H6.78697L1.35739 15.5V2.375Z"
                fill="#6C8A1F"
              />
            </mask>
            <g mask={`url(#mask0_${uniqueId})`}>
              <path
                d="M300.34 12.6783C300.31 13.5856 300.25 14.4999 300.175 15.421C296.23 15.5873 292.358 15.7327 288.577 15.9267C287.695 15.9751 286.813 16.0167 285.931 16.0583C282.673 16.2176 279.415 16.363 276.141 16.4946C274.512 16.5569 272.868 16.6193 271.239 16.6816C270.193 16.7232 269.266 16.9102 268.235 16.9656C266.815 17.0418 265.26 16.8686 263.826 16.8271C262.226 16.7855 260.627 16.7717 259.043 16.7786C255.829 16.7994 252.631 16.9102 249.447 17.0764C243.065 17.4158 236.743 17.9768 230.405 18.4686C220.242 19.2582 210.018 19.8469 199.765 20.2486C205.355 20.5049 210.915 20.9274 216.385 21.5161C214.338 21.5923 212.275 21.6616 210.228 21.7239C203.711 21.9109 197.164 22.0079 190.633 22.0563C184.086 22.1048 177.555 22.1048 171.008 22.1048C164.461 22.1048 157.93 22.091 151.383 22.1187C144.852 22.1464 138.305 22.2087 131.788 22.3542C128.53 22.4234 125.257 22.5204 122.013 22.6312C121.191 22.6589 120.384 22.6936 119.577 22.7213C118.591 22.7628 117.649 22.8944 116.633 22.9429C108.831 23.3654 101.058 23.8918 93.3611 24.5983C81.3889 25.6926 69.357 26.7523 57.1906 27.1402C54.9935 27.2025 52.7814 27.2718 50.5843 27.3341C40.0918 28.3107 28.7774 28.5116 18.4792 29.0934C14.9818 29.2942 11.4245 29.405 7.85231 29.4674C5.70002 29.3012 3.54773 29.0864 1.44027 28.8371C0.932095 28.7817 0.379076 28.6986 -0.0992115 28.5947C-0.771803 28.4562 -1.33977 28.2553 -1.6387 27.9575C-1.89279 27.7012 -1.87784 27.4103 -1.86289 27.1402C-1.84795 26.877 -1.92268 26.5999 -1.89279 26.3367C-1.84795 25.7688 -1.68354 25.2147 -1.56397 24.6537C7.85231 24.2935 17.5077 23.026 26.5653 22.4234C38.1936 21.6546 50.0313 21.1975 61.7642 20.8927C75.0367 20.5534 88.2793 21.2806 101.507 21.2806C113.763 21.2806 126.004 20.7819 138.2 20.3317C161.965 19.4382 185.7 18.5171 209.45 17.5612C204.279 17.5197 199.122 17.4573 193.951 17.3742C187.374 17.2703 180.783 17.1318 174.207 16.9725C172.667 16.9379 171.098 16.8409 169.588 16.924C168.019 17.0071 166.419 17.0279 164.85 17.021C161.711 17.0002 158.587 16.8132 155.538 16.4669C153.745 16.266 151.981 16.0028 150.173 15.8574C147.109 15.6081 143.97 15.6842 140.861 15.6704C129.233 15.6011 117.784 14.1743 106.155 14.2297C103.106 14.2436 100.057 14.3613 97.0229 14.486C93.7945 14.6176 90.5661 14.7631 87.3227 14.7977C85.8878 14.8115 84.3932 14.867 83.0032 14.7146C81.927 14.5968 80.7014 14.6592 79.5954 14.6453C77.6224 14.6176 75.6645 14.5968 73.6915 14.583C69.7606 14.5483 65.8297 14.5206 61.8838 14.5137C46.9822 14.4791 32.0955 14.8669 17.1939 14.8115C10.8267 14.7908 4.36978 14.7284 -1.93763 14.299C-1.96752 14.2921 -1.98247 14.2782 -1.99741 14.2713C-2.19172 14.1466 -2.23656 13.9942 -2.26645 13.8349C-2.72979 11.2653 -2.20666 8.61951 -2.52054 6.03604C-2.55043 5.89059 -2.62516 5.16334 -2.71484 4.34605C4.89291 4.04129 12.5455 3.96511 20.1533 3.70884C35.025 3.18937 49.9266 2.97466 64.8731 3.00236C94.497 3.0647 124.061 3.94433 153.595 4.98326C183.145 6.02911 212.634 7.30354 242.198 8.2732C257.145 8.76496 272.091 9.06279 287.067 9.06279C291.462 9.06279 295.886 8.93812 300.31 8.78574C300.295 9.47144 300.026 10.1294 300.026 10.829C300.026 11.4454 300.355 12.048 300.34 12.6783ZM300.803 30.6656C300.699 29.6059 300.699 28.5462 300.699 27.4865C291.267 27.0155 281.821 26.5237 272.33 26.219C256.053 25.7065 239.717 25.7826 223.44 26.0943C220.047 26.1567 216.714 26.1982 213.351 26.3922C211.722 26.4891 210.108 26.5792 208.479 26.6692C201.977 27.0224 195.46 27.3203 188.929 27.5488C186.388 27.6389 183.832 27.722 181.291 27.7912C187.897 27.7705 194.489 27.7497 201.095 27.722C207.702 27.7012 214.293 27.6804 220.899 27.6527C224.202 27.6389 227.506 27.6319 230.794 27.6181C232.438 27.6181 234.097 27.6042 235.741 27.6042C236.444 27.6042 237.146 27.625 237.834 27.5558C238.252 27.5142 238.641 27.4311 239.074 27.4034C240.554 27.2995 242.213 27.438 243.693 27.4726C245.322 27.5142 246.966 27.5558 248.595 27.6042C251.868 27.6943 255.142 27.8051 258.415 27.9159C263.571 28.096 268.713 28.2969 273.87 28.5116C279.489 28.7471 285.064 29.0518 290.654 29.3704C277.965 29.9314 265.275 30.5132 252.556 30.8388C223.276 31.5868 193.996 32.5288 164.671 32.2656C135.749 32.0024 106.903 31.2336 77.9662 31.2821C62.7208 31.3028 47.4754 31.4206 32.2599 31.6284C21.0351 31.7807 9.64589 31.753 -1.57891 32.2863C-1.80311 32.6396 -1.89279 33.0275 -1.96752 33.3945C-2.08709 34.0456 -2.13193 34.7174 -2.29634 35.3685C10.1989 35.604 22.8287 35.2092 35.294 35.1954C50.5245 35.1815 65.7699 35.2508 81.0003 35.417C109.877 35.7356 138.709 36.4767 167.585 36.7122C196.955 36.9546 226.28 35.978 255.575 35.2992C270.686 34.946 285.901 34.9391 301.027 34.8698H301.341C301.147 33.4707 300.953 32.0716 300.818 30.6725L300.803 30.6656Z"
                fill="#648219"
              />
            </g>
            <path
              d="M199.012 11.1985C194.896 11.1279 190.78 10.8897 186.681 10.6427C168.16 9.54897 149.639 8.45519 131.119 7.36141C111.046 6.1706 90.8269 4.9798 70.6729 5.73838C67.9944 5.72074 65.1362 5.89716 62.4414 5.87952C74.7886 6.62046 87.2501 6.84981 99.6627 6.56754C104.546 6.45287 109.462 6.26763 114.329 6.53226C118.232 6.74396 122.054 7.25556 125.876 7.70542C133.062 8.55222 140.314 9.21378 147.614 9.75185C167.948 11.2602 188.51 11.8071 209.04 11.7453C205.267 11.4984 202.801 11.269 199.012 11.1985Z"
              fill="#4E6417"
            />
            <g clipPath={`url(#clip1_${uniqueId})`}>
              <path
                d="M81.4441 26.75C74.215 27.5466 66.9982 28.3431 59.7691 29.1345C56.3202 29.5121 52.8713 29.8949 49.3611 30.1225C45.004 30.4069 40.5733 30.4535 36.1671 30.4794C32.2518 30.5 28.3488 30.5052 24.4336 30.4845C25.9432 30.3863 27.4652 30.3035 28.9748 30.2363C29.5885 30.2104 30.2635 30.2207 30.8649 30.1794C34.056 29.9725 37.0753 30.0604 40.3278 30.0087C43.7153 29.9569 47.066 29.5742 50.3921 29.3414C55.682 28.9742 60.9351 28.5552 66.1881 28.1052C71.2816 27.6707 76.3629 27.2052 81.4441 26.7449V26.75Z"
                fill="#4E6417"
              />
            </g>
            <g clipPath={`url(#clip2_${uniqueId})`}>
              <path
                d="M206.32 32.2332C213.223 32.7163 220.187 33.1994 227.121 32.9234C231.595 32.747 236.007 32.2562 240.481 32.0108C245.785 31.7194 251.135 31.7807 256.454 31.7424C266.016 31.6657 275.579 31.2592 285.034 30.523C282.389 30.4924 279.73 30.5 277.086 30.546C274.749 30.5921 272.443 30.523 270.106 30.546C264.91 30.5997 259.729 30.7684 254.563 30.9755C249.397 31.1902 244.247 31.451 239.082 31.6887C233.932 31.9264 228.781 32.1411 223.616 32.2638C218.45 32.3865 213.269 32.4172 208.088 32.2868C207.504 32.2715 206.889 32.2792 206.32 32.2332Z"
                fill="#4E6417"
              />
            </g>
          </g>
          <defs>
            <clipPath id={`clip0_${uniqueId}`}>
              <rect width="299" height="40" fill="white" transform="translate(0 0.5)" />
            </clipPath>
            <clipPath id={`clip1_${uniqueId}`}>
              <rect
                width="57.0105"
                height="3.75"
                fill="white"
                transform="translate(24.4336 26.75)"
              />
            </clipPath>
            <clipPath id={`clip2_${uniqueId}`}>
              <rect width="78.7288" height="2.5" fill="white" transform="translate(206.32 30.5)" />
            </clipPath>
          </defs>
        </svg>
      </div>

      {/* TEXT */}
      <span className="relative text-white z-10 flex items-center justify-center w-full h-full font-medium button-1 spin-animation">
        <span>{name}</span>
      </span>
    </>
  );

  // Container: giữ tỉ lệ 299:40, width linh hoạt, height tự tính theo width
  const container = cx(
    "relative inline-flex items-center justify-center overflow-hidden cursor-pointer",
    fullWidth ? "w-full" : "w-auto",
    maxWidth, // giới hạn tối đa (có thể đổi qua prop)
    "aspect-[299/40]", // KEY: giữ đúng tỷ lệ, không cần h-*
    className
  );

  if (href && !onClick) {
    return (
      <Link href={href} aria-label={name} className={container}>
        {Inner}
      </Link>
    );
  }

  return (
    <button
      type={type}
      disabled={disabled}
      onClick={onClick}
      aria-label={name}
      className={container}
    >
      {Inner}
    </button>
  );
};

export default ButtonTour;
